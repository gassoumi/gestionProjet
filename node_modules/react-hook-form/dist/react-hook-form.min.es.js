import{isValidElement as e,useRef as r,useState as t,useCallback as n,useEffect as c,createContext as s,useContext as u,createElement as i,useMemo as a,cloneElement as o,Fragment as l}from"react";var f=e=>void 0===e,d=e=>null===e||f(e),g=e=>Array.isArray(e);const h=e=>"object"==typeof e;var m=e=>!d(e)&&!g(e)&&h(e),v=e=>m(e)&&e.nodeType===Node.ELEMENT_NODE;const b={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit"},p="undefined",O={BLUR:"blur",CHANGE:"change",INPUT:"input"},y="max",j="min",R="maxLength",x="minLength",S="pattern",E="required",V="validate",w=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,B=/^\w*$/,N=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,C=/\\(\\)?/g,k=/[\d+]/g;var F=e=>!g(e)&&(B.test(e)||!w.test(e)),$=e=>{const r=[];return e.replace(N,(e,t,n,c)=>{r.push(n?c.replace(C,"$1"):t||e)}),r};function L(e,r,t){let n=-1;const c=F(r)?[r]:$(r),s=c.length,u=s-1;for(;++n<s;){const r=c[n];let s=t;if(n!==u){const t=e[r];s=m(t)||g(t)?t:isNaN(+c[n+1])?{}:[]}e[r]=s,e=e[r]}return e}var A=e=>Object.entries(e).reduce((e,[r,t])=>F(r)?Object.assign(Object.assign({},e),{[r]:t}):(L(e,r,t),e),{}),P=(e,r,t)=>{const n=r.split(/[,[\].]+?/).filter(Boolean).reduce((e,r)=>d(e)?e:e[r],e);return f(n)||n===e?e[r]||t:n},D=(e,r)=>{for(const t in e)if(P(r,t)){const r=e[t];if(r){if(r.ref.focus){r.ref.focus();break}if(r.options){r.options[0].ref.focus();break}}}},M=(e,r)=>{v(e)&&e.removeEventListener&&(e.removeEventListener(O.INPUT,r),e.removeEventListener(O.CHANGE,r),e.removeEventListener(O.BLUR,r))},W=e=>"radio"===e.type,T=e=>"checkbox"===e.type;function U(e){return!e||e instanceof HTMLElement&&e.nodeType!==Node.DOCUMENT_NODE&&U(e.parentNode)}var I=e=>m(e)&&!Object.keys(e).length;function z(e){return g(e)?e:$(e)}function H(e,r){return 1==r.length?e:function(e,r){const t=F(r)?[r]:z(r),n=r.length;let c=0;for(;c<n;)e=f(e)?c++:e[t[c++]];return c==n?e:void 0}(e,function(e,r,t){let n=-1,c=e.length;r<0&&(r=-r>c?0:c+r),(t=t>c?c:t)<0&&(t+=c),c=r>t?0:t-r;const s=Array(c);for(;++n<c;)s[n]=e[n+r];return s}(r,0,-1))}function G(e,r){return r.forEach(r=>{!function(e,r){const t=F(r)?[r]:z(r),n=H(e,t),c=t[t.length-1],s=!(null!=n)||delete n[c];let u=void 0;for(let r=0;r<t.slice(0,-1).length;r++){let n=-1,c=void 0;const s=t.slice(0,-(r+1)),i=s.length-1;for(r>0&&(u=e);++n<s.length;){const r=s[n];c=c?c[r]:e[r],i===n&&(m(c)&&I(c)||g(c)&&!c.filter(e=>m(e)&&!I(e)).length)&&(u?delete u[r]:delete e[r]),u=c}}}(e,r)}),e}const _={isValid:!1,value:""};var q=e=>g(e)?e.filter(Boolean).reduce((e,{ref:{checked:r,value:t}})=>r?{isValid:!0,value:t}:e,_):_,J=e=>[...e].filter(({selected:e})=>e).map(({value:e})=>e),K=e=>"file"===e.type,Q=e=>"select-multiple"===e.type,X=e=>""===e;const Y={value:!1,isValid:!1},Z={value:!0,isValid:!0};var ee=e=>{if(g(e)){if(e.length>1){const r=e.filter(({ref:{checked:e}})=>e).map(({ref:{value:e}})=>e);return{value:r,isValid:!!r.length}}const{checked:r,value:t,attributes:n}=e[0].ref;return r?n&&!f(n.value)?f(t)||X(t)?Z:{value:t,isValid:!0}:Z:Y}return Y};function re(e,r){const{name:t,value:n}=r,c=e[t];return K(r)?r.files:W(r)?c?q(c.options).value:"":Q(r)?J(r.options):T(r)?!!c&&ee(c.options).value:n}var te=e=>"string"==typeof e,ne=(e,r)=>{const t={};for(const n in e)(f(r)||(te(r)?n.startsWith(r):g(r)?r.find(e=>n.startsWith(e)):r&&r.nest))&&(t[n]=re(e,e[n].ref));return t},ce=(e,{type:r,types:t,message:n})=>m(e)&&e.type===r&&e.message===n&&((e={},r={})=>{const t=Object.entries(e),n=Object.keys(r);return t.length===n.length&&t.reduce((e,[t,n])=>!!e&&r[t]&&r[t]===n,!0)})(e.types,t);var se=e=>e instanceof RegExp,ue=e=>{return(e=>m(e)&&!se(e))(e)?e:{value:e,message:""}},ie=e=>"function"==typeof e,ae=e=>"boolean"==typeof e,oe=r=>te(r)||m(r)&&e(r);function le(e,r,t="validate"){if(oe(e)||ae(e)&&!e)return{type:t,message:oe(e)?e:"",ref:r}}var fe=(e,r,t,n,c)=>{if(r){const r=t[e];return Object.assign(Object.assign({},r),{types:Object.assign(Object.assign({},r&&r.types?r.types:{}),{[n]:c||!0})})}return{}},de=async(e,r,{ref:t,ref:{type:n,value:c,name:s},options:u,required:i,maxLength:a,minLength:o,min:l,max:f,pattern:g,validate:h})=>{var v;const b=e.current,p={},O=W(t),w=T(t),B=O||w,N=X(c),C=fe.bind(null,s,r,p),k=(e,n,c,u=R,i=x)=>{const a=e?n:c;if(p[s]=Object.assign({type:e?u:i,message:a,ref:t},C(e?u:i,a)),!r)return p};if(i&&(!O&&!w&&(N||d(c))||ae(c)&&!c||w&&!ee(u).isValid||O&&!q(u).isValid)){const{value:e,message:n}=oe(i)?{value:!!i,message:i}:ue(i);if(e&&(p[s]=Object.assign({type:E,message:n,ref:B?null===(v=b[s].options)||void 0===v?void 0:v[0].ref:t},C(E,n)),!r))return p}if(!d(l)||!d(f)){let e,s;const{value:u,message:i}=ue(f),{value:a,message:o}=ue(l);if("number"===n||!n&&!isNaN(c)){const r=t.valueAsNumber||parseFloat(c);d(u)||(e=r>u),d(a)||(s=r<a)}else{const r=t.valueAsDate||new Date(c);te(u)&&(e=r>new Date(u)),te(a)&&(s=r<new Date(a))}if((e||s)&&(k(!!e,i,o,y,j),!r))return p}if(te(c)&&!N&&(a||o)){const{value:e,message:t}=ue(a),{value:n,message:s}=ue(o),u=c.toString().length,i=!d(e)&&u>e,l=!d(n)&&u<n;if((i||l)&&(k(!!i,t,s),!r))return p}if(g&&!N){const{value:e,message:n}=ue(g);if(se(e)&&!e.test(c)&&(p[s]=Object.assign({type:S,message:n,ref:t},C(S,n)),!r))return p}if(h){const e=re(b,t),n=B&&u?u[0].ref:t;if(ie(h)){const t=le(await h(e),n);if(t&&(p[s]=Object.assign(Object.assign({},t),C(V,t.message)),!r))return p}else if(m(h)){let t={};for(const[c,u]of Object.entries(h)){if(!I(t)&&!r)break;const i=le(await u(e),n,c);i&&(t=Object.assign(Object.assign({},i),C(c,i.message)),r&&(p[s]=t))}if(!I(t)&&(p[s]=Object.assign({ref:n},t),!r))return p}}return p};const ge=(e,r)=>g(e.inner)?e.inner.reduce((e,{path:t,message:n,type:c})=>Object.assign(Object.assign({},e),e[t]&&r?{[t]:fe(t,r,e,c,n)}:{[t]:e[t]||Object.assign({message:n,type:c},r?{types:{[c]:n||!0}}:{})}),{}):{[e.path]:{message:e.message,type:e.type}};async function he(e,r,t,n,c){if(n)return n(t,c);try{return{values:await e.validate(t,{abortEarly:!1,context:c}),errors:{}}}catch(e){return{values:{},errors:A(ge(e,r))}}}var me=e=>d(e)||!h(e);const ve=(e,r)=>{const t=(r,t,n)=>{const c=n?`${e}.${t}`:`${e}[${t}]`;return me(r)?c:ve(c,r)};return g(r)?r.map((e,r)=>t(e,r)):Object.entries(r).map(([e,r])=>t(r,e,!0))};var be=(e,r,t,n)=>{let c;return t.add(r),I(e)?c=void 0:f(e[r])?(c=P(A(e),r),f(c)||((e,r)=>ve(e,r).flat(1/0))(r,c).forEach(e=>t.add(e))):(c=e[r],t.add(r)),f(c)?m(n)?P(n,r):n:c},pe=({isOnChange:e,hasError:r,isBlurEvent:t,isOnSubmit:n,isReValidateOnSubmit:c,isOnBlur:s,isReValidateOnBlur:u,isSubmitted:i})=>e&&t||n&&c||n&&!i||s&&!t&&!r||u&&!t&&r||c&&i,Oe=e=>e.substring(0,e.indexOf("[")),ye=(e,r)=>{const t=A(ne(e));return r?P(t,r,t):t};function je(e,r){let t=!1;if(!g(e)||!g(r)||e.length!==r.length)return!0;for(let n=0;n<e.length&&!t;n++){const c=e[n],s=r[n];if(f(s)||Object.keys(c).length!==Object.keys(s).length){t=!0;break}for(const e in c)if(c[e]!==s[e]){t=!0;break}}return t}const Re=(e,r)=>RegExp(`^${r}[\\d+]`.replace(/\[/g,"\\[").replace(/\]/g,"\\]")).test(e);var xe=(e,r)=>[...e].reduce((e,t)=>!!Re(r,t)||e,!1);var Se=e=>({isOnSubmit:!e||e===b.onSubmit,isOnBlur:e===b.onBlur,isOnChange:e===b.onChange}),Ee=e=>W(e)||T(e);function Ve({mode:e=b.onSubmit,reValidateMode:s=b.onChange,validationSchema:u,validationResolver:i,validationContext:a,defaultValues:o={},submitFocusError:l=!0,validateCriteriaMode:h}={}){const y=r({}),j=r({}),R=r({}),x=r({}),S=r(new Set),E=r(new Set),V=r(new Set),w=r(new Set),B=r(!0),N=r(o),C=r({}),k=r(!1),F=r(!1),$=r(!1),z=r(!1),H=r(0),_=r(!1),q=r(),J=r({}),X=r(a),Y=r(new Set),[,Z]=t(),{isOnBlur:ee,isOnSubmit:se,isOnChange:ue}=r(Se(e)).current,oe="all"===h,le=typeof window===p,fe=!(!u&&!i),ge=typeof document!==p&&!le&&!f(window.HTMLElement),ve=ge?"Proxy"in window:typeof Proxy!==p,Re=r(),Ve=r({dirty:!ve,dirtyFields:!ve,isSubmitted:se,submitCount:!ve,touched:!ve,isSubmitting:!ve,isValid:!ve}),{isOnBlur:we,isOnSubmit:Be}=r(Se(s)).current;X.current=a;const Ne=n(()=>{k.current||Z({})},[]),Ce=n((e,r,t=!1)=>{let n=t||function({errors:e,name:r,error:t,validFields:n,fieldsWithValidation:c}){const s=I(t),u=I(e),i=P(t,r),a=P(e,r);return!(s&&n.has(r)||a&&a.isManual)&&(!!(u!==s||!u&&!a||s&&c.has(r)&&!n.has(r))||i&&!ce(a,i))}({errors:j.current,error:r,name:e,validFields:w.current,fieldsWithValidation:V.current});if(I(r)?((V.current.has(e)||fe)&&(w.current.add(e),n=n||P(j.current,e)),j.current=G(j.current,[e])):(w.current.delete(e),n=n||!P(j.current,e),L(j.current,e,r[e])),n&&!d(t))return Ne(),!0},[Ne,fe]),ke=n((e,r)=>{const{ref:t,options:n}=e,c=ge&&v(t)&&d(r)?"":r;W(t)&&n?n.forEach(({ref:e})=>e.checked=e.value===c):K(t)?te(c)?t.value=c:t.files=c:Q(t)?[...t.options].forEach(e=>e.selected=c.includes(e.value)):T(t)&&n?n.length>1?n.forEach(({ref:e})=>e.checked=c.includes(e.value)):n[0].ref.checked=!!c:t.value=c},[ge]),Fe=e=>{if(!y.current[e]||!Ve.current.dirty&&!Ve.current.dirtyFields)return!1;let r=C.current[e]!==re(y.current,y.current[e].ref);const t=xe(Y.current,e),n=E.current.size;if(t){const t=Oe(e);r=je(ye(y.current,t),P(N.current,t))}const c=(t?z.current:E.current.has(e))!==r;return r?E.current.add(e):E.current.delete(e),z.current=t?r:!!E.current.size,Ve.current.dirty?c:n!==E.current.size},$e=n(e=>{if(Fe(e)||!P(R.current,e)&&Ve.current.touched)return!!L(R.current,e,!0)},[]),Le=n((e,r,t)=>{const n=g(r);for(const c in r){const s=`${t||e}${n?`[${c}]`:`.${c}`}`,u=y.current[s];m(r[c])&&Le(e,r[c],s),u&&(ke(u,r[c]),$e(s))}},[ke,$e]),Ae=n((e,r)=>{const t=y.current[e];if(t){ke(t,r);const n=$e(e);if(ae(n))return n}else me(r)||Le(e,r)},[$e,ke,Le]),Pe=n(async(e,r)=>{const t=y.current[e];if(t){const n=await de(y,oe,t);return Ce(e,n,!!r&&null),I(n)}return!1},[Ce,oe]),De=n(async e=>{const{errors:r}=await he(u,oe,ye(y.current),i,X.current),t=B.current;if(B.current=I(r),g(e))e.forEach(e=>{const t=P(r,e);t?L(j.current,e,t):G(j.current,[e])}),Ne();else{const n=P(r,e);Ce(e,n?{[e]:n}:{},t!==B.current)}return I(j.current)},[Ne,Ce,oe,i,u]),Me=n(async e=>{const r=e||Object.keys(y.current);if(fe)return De(r);if(g(r)){const e=await Promise.all(r.map(async e=>await Pe(e,!0)));return Ne(),e.every(Boolean)}return await Pe(r)},[De,Pe,Ne,fe]),We=e=>F.current||S.current.has(e)||S.current.has((e.match(/\w+/)||[])[0]);q.current=q.current?q.current:async({type:e,target:r})=>{const t=r?r.name:"",n=y.current,c=j.current,s=n[t],a=P(c,t);let o;if(!s)return;const l=e===O.BLUR,f=pe({hasError:!!a,isOnChange:ue,isBlurEvent:l,isOnSubmit:se,isReValidateOnSubmit:Be,isOnBlur:ee,isReValidateOnBlur:we,isSubmitted:$.current}),d=Fe(t);let g=We(t)||d;if(l&&!P(R.current,t)&&Ve.current.touched&&(L(R.current,t,!0),g=!0),f)return g&&Ne();if(fe){const{errors:e}=await he(u,oe,ye(n),i,X.current),r=B.current;B.current=I(e),o=P(e,t)?{[t]:P(e,t)}:{},r!==B.current&&(g=!0)}else o=await de(y,oe,s);!Ce(t,o)&&g&&Ne()};const Te=n((e={})=>{const r=I(N.current)?ne(y.current):N.current;he(u,oe,A(Object.assign(Object.assign({},r),e)),i,X.current).then(({errors:e})=>{const r=B.current;B.current=I(e),r!==B.current&&Ne()})},[Ne,oe,i]),Ue=n((e,r)=>{q.current&&e&&function(e,r,t,n){const{ref:c,ref:{name:s,type:u},mutationWatcher:i}=t;if(!u)return void delete e[s];const a=e[s];if((W(c)||T(c))&&a){const{options:t}=a;g(t)&&t.length?(t.filter(Boolean).forEach(({ref:e,mutationWatcher:c},s)=>{(e&&U(e)||n)&&(M(e,r),c&&c.disconnect(),G(t,[`[${s}]`]))}),t&&!t.filter(Boolean).length&&delete e[s]):delete e[s]}else(U(c)||n)&&(M(c,r),i&&i.disconnect(),delete e[s])}(y.current,q.current,e,r)},[]),Ie=n((e,r)=>{if(!e||e&&xe(Y.current,e.ref.name)&&!r)return;Ue(e,r);const{name:t}=e.ref;j.current=G(j.current,[t]),R.current=G(R.current,[t]),C.current=G(C.current,[t]),[E,V,w,S].forEach(e=>e.current.delete(t)),(Ve.current.isValid||Ve.current.touched)&&(Ne(),fe&&Te())},[Ne,fe,Te,Ue]);const ze=({name:e,type:r,types:t,message:n,shouldRender:c})=>{const s=y.current[e];ce(j.current[e],{type:r,message:n,types:t})||(L(j.current,e,{type:r,types:t,message:n,ref:s?s.ref:{},isManual:!0}),c&&Ne())};function He(e,r={}){if(!e.name)return console.warn("Missing name @",e);const{name:t,type:n,value:c}=e,s=Object.assign({ref:e},r),u=y.current,i=Ee(e);let a,o,l=u[t],d=!0;if(i?l&&g(l.options)&&l.options.filter(Boolean).find(({ref:e})=>c===e.value):l)u[t]=Object.assign(Object.assign({},l),r);else{if(n){const c=function(e,r){const t=new MutationObserver(()=>{U(e)&&(t.disconnect(),r())});return t.observe(window.document,{childList:!0,subtree:!0}),t}(e,()=>Ie(l));l=i?Object.assign({options:[...l&&l.options||[],{ref:e,mutationWatcher:c}],ref:{type:n,name:t}},r):Object.assign(Object.assign({},s),{mutationWatcher:c})}else l=s;u[t]=l,I(N.current)||(o=P(N.current,t),d=f(o),a=xe(Y.current,t),d||a||ke(l,o)),fe&&!a&&Ve.current.isValid?Te():I(r)||(V.current.add(t),!se&&Ve.current.isValid&&de(y,oe,l).then(e=>{const r=B.current;I(e)?w.current.add(t):B.current=!1,r!==B.current&&Ne()})),C.current[t]||a&&d||(C.current[t]=d?re(u,l.ref):o),n&&function({field:{ref:e},handleChange:r,isRadioOrCheckbox:t}){v(e)&&r&&(e.addEventListener(t?O.CHANGE:O.INPUT,r),e.addEventListener(O.BLUR,r))}({field:i&&l.options?l.options[l.options.length-1]:l,isRadioOrCheckbox:i,handleChange:q.current})}}const Ge=n(e=>async r=>{r&&(r.preventDefault(),r.persist());let t={};const n=y.current,c=ne(n);Ve.current.isSubmitting&&(_.current=!0,Ne());try{if(fe){const{errors:e}=await he(u,oe,A(c),i,X.current);j.current=e,t=e}else for(const e of Object.values(n))if(e){const{ref:{name:r}}=e,n=await de(y,oe,e);n[r]?(L(t,r,n[r]),w.current.delete(r)):V.current.has(r)&&w.current.add(r)}I(t)?(j.current={},await e(A(c),r)):(j.current=t,l&&ge&&D(n,t))}finally{$.current=!0,_.current=!1,H.current=H.current+1,Ne()}},[ge,Ne,fe,l,oe,i,u]);c(()=>()=>{k.current=!0,y.current&&"production"===process.env.NODE_ENV&&Object.values(y.current).forEach(e=>Ie(e,!0))},[Ie]),fe||(B.current=w.current.size>=V.current.size&&I(j.current));const _e={dirty:z.current,dirtyFields:E.current,isSubmitted:$.current,submitCount:H.current,touched:R.current,isSubmitting:_.current,isValid:se?$.current&&I(j.current):B.current};Re.current=new Proxy(_e,{get:(e,r)=>r in e?(Ve.current[r]=!0,e[r]):{}});const qe={triggerValidation:Me,setValue:n(function(e,r,t){let n=!1;const c=g(e);(c?e:[e]).forEach(e=>{const t=te(e);n=!(!Ae(t?e:Object.keys(e)[0],t?r:Object.values(e)[0])&&!c)||We(e)}),(n||c)&&Ne(),(t||c&&r)&&Me(c?void 0:e)},[Ne,Ae,Me]),register:n(function(e,r){if(!le)if(te(e))He({name:e},r);else{if(!(m(e)&&"name"in e))return r=>r&&He(r,e);He(e,r)}},[N.current,C.current]),unregister:n(function(e){y.current&&(g(e)?e:[e]).forEach(e=>Ie(y.current[e],!0))},[]),getValues:n(function(e){if(te(e))return y.current[e]?re(y.current,y.current[e].ref):void 0;const r=ne(y.current),t=I(r)?N.current:r;return e&&e.nest?A(t):t},[]),formState:ve?Re.current:_e},Je=Object.assign(Object.assign(Object.assign({removeFieldEventListener:Ue,reRender:Ne},fe?{validateSchemaIsValid:Te}:{}),{mode:{isOnBlur:ee,isOnSubmit:se,isOnChange:ue},reValidateMode:{isReValidateOnBlur:we,isReValidateOnSubmit:Be},errorsRef:j,touchedFieldsRef:R,fieldsRef:y,isWatchAllRef:F,watchFieldsRef:S,resetFieldArrayFunctionRef:J,fieldArrayDefaultValues:x,validFieldsRef:w,dirtyFieldsRef:E,fieldsWithValidationRef:V,fieldArrayNamesRef:Y,isDirtyRef:z,readFormStateRef:Ve,defaultValuesRef:N}),qe);return Object.assign({watch:function(e,r){const t=S.current,n=f(r)?f(N.current)?{}:N.current:r,c=ne(y.current,e);if(te(e))return be(c,e,t,n);if(g(e))return e.reduce((e,r)=>Object.assign(Object.assign({},e),{[r]:be(c,r,t,n)}),{});F.current=!0;const s=!I(c)&&c||n;return e&&e.nest?A(s):s},control:Je,handleSubmit:Ge,reset:n((e,r={})=>{if(ge)for(const e of Object.values(y.current))if(e){const{ref:r,options:t}=e,n=Ee(r)&&g(t)?t[0].ref:r;if(v(n))try{n.closest("form").reset();break}catch(e){}}e&&(N.current=e),Object.values(J.current).forEach(e=>ie(e)&&e()),(({errors:e,dirty:r,isSubmitted:t,touched:n,isValid:c,submitCount:s,dirtyFields:u})=>{y.current={},e||(j.current={}),n||(R.current={}),c||(w.current=new Set,V.current=new Set,B.current=!0),r||(z.current=!1),u||(E.current=new Set),t||($.current=!1),s||(H.current=0),C.current={},x.current={},S.current=new Set,F.current=!1})(r),Ne()},[]),clearError:n(function(e){e?G(j.current,g(e)?e:[e]):j.current={},Ne()},[]),setError:n(function(e,r="",t){te(e)?ze(Object.assign(Object.assign({name:e},m(r)?{types:r,type:""}:{type:r,message:t}),{shouldRender:!0})):g(e)&&(e.forEach(e=>ze(Object.assign({},e))),Ne())},[]),errors:j.current},qe)}function we(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var c=0;for(n=Object.getOwnPropertySymbols(e);c<n.length;c++)r.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(e,n[c])&&(t[n[c]]=e[n[c]])}return t}const Be=s(null);function Ne(){return u(Be)}function Ce(e){var{children:r,formState:t,errors:n}=e,c=we(e,["children","formState","errors"]);return i(Be.Provider,{value:Object.assign(Object.assign({},c),{formState:t,errors:n})},r)}var ke=()=>{const e=typeof performance===p?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const t=(16*Math.random()+e)%16|0;return("x"==r?t:3&t|8).toString(16)})};const Fe=(e,r)=>Object.assign({[r]:ke()},m(e)?e:{value:e}),$e=(e,r)=>(g(e)?e:[]).map(e=>Fe(e,r));var Le=(e,r)=>f(r)?[]:g(r)?function(e,r){let t=-1;for(;++t<e.length;)r.indexOf(t)>=0&&delete e[t];return e.filter(Boolean)}(e,r):((e,r)=>[...e.slice(0,r),...e.slice(r+1)])(e,r),Ae=(e,r,t)=>g(e)?e.splice(t,0,e.splice(r,1)[0]):[],Pe=(e,r,t)=>{const n=[e[t],e[r]];e[r]=n[0],e[t]=n[1]};function De(e,r){return[...g(r)?r:[r||null],...e]}function Me(e,r,t){return[...e.slice(0,r),...g(t)?t:[t||null],...e.slice(r)]}var We=e=>g(e)?Array(e.length).fill(null):null;const Te=({control:e,name:s,keyName:u="id"})=>{const i=Ne(),{isWatchAllRef:a,resetFieldArrayFunctionRef:o,fieldArrayNamesRef:l,reRender:d,fieldsRef:h,getValues:m,defaultValuesRef:v,removeFieldEventListener:b,errorsRef:p,dirtyFieldsRef:O,isDirtyRef:y,touchedFieldsRef:j,readFormStateRef:R,watchFieldsRef:x,validFieldsRef:S,fieldsWithValidationRef:E,fieldArrayDefaultValues:V,validateSchemaIsValid:w}=e||i.control,B=()=>[...P(V.current[Oe(s)]?V.current:v.current,s,[])],N=r(B()),[C,$]=t($e(N.current,u)),[L,A]=t(!1),D=r(C),M=F(s);D.current=C,M&&(V.current[s]=N.current);const W=e=>e.map(e=>Fe(e,u)),T=e=>{$(e),R.current.isValid&&w&&w({[s]:e})},U=({shouldRender:e,isRemove:r,isPrePend:t,index:n,value:c={}}={})=>{let u=e;const i=g(c)?c:[c];if(R.current.dirty){const e={};if(t||r)for(const r of[...O.current].sort())if(Re(r,s)){const t=r.match(k);if(t){const n=+t[t.length-1];e[n]?e[n].push(r):e[n]=[r]}O.current.delete(r)}if(!f(n)||t){const r=f(n)?[]:((e,r,t=[],n=0,c=[])=>{for(const t of r)e.indexOf(t)<0&&c.push(t);for(const s of e.sort())r.indexOf(s)>-1?(t.push(-1),n++):t.push(s-n-(c.length?c.map(e=>e<s).filter(Boolean).length:0));return t})(Object.keys(e).map(e=>+e),g(n)?n:[n]);Object.values(e).forEach((e,n)=>{const c=t?0:r[n];if(c>-1)for(const r of e){const n=r.match(k);n&&O.current.add(r.replace(/[\d+]([^[\d+]+)$/,`${t?+n[n.length-1]+e.length:c}$1`))}})}r||(i.forEach((e,r)=>Object.keys(e).forEach(e=>O.current.add(`${s}[${t?r:D.current.length+r}].${e}`))),y.current=!0),u=!0}u&&!a.current&&d()},I=e=>{R.current.dirty&&(y.current=!!f(e)||je(e,v.current[s]||[]));for(const e in h.current)Re(e,s)&&h.current[e]&&b(h.current[e],!0)},z=()=>{const e=P(m({nest:!0}),s);if(g(e))for(let r=0;r<e.length;r++)D.current[r]=Object.assign(Object.assign({},D.current[r]),e[r])},H=()=>{I(),N.current=B(),$($e(N.current,u))};return c(()=>{M&&L&&V.current[s]&&C.length<V.current[s].length&&V.current[s].pop()},[C,s,V,L,M]),c(()=>{if(a&&a.current)d();else if(x)for(const e of x.current)if(e.startsWith(s)){d();break}},[C,s,d,x,a]),c(()=>{const e=o.current,r=l.current;return r.add(s),e[s]=H,()=>{I(),delete e[s],r.delete(s)}},[]),{swap:n((e,r)=>{z();const t=ye(h.current,s);Pe(t,e,r),I(t),Pe(D.current,e,r),T([...D.current]),p.current[s]&&Pe(p.current[s],e,r),R.current.touched&&j.current[s]&&(Pe(j.current[s],e,r),d())},[s]),move:n((e,r)=>{z();const t=ye(h.current,s);Ae(t,e,r),I(t),Ae(D.current,e,r),T([...D.current]),p.current[s]&&Ae(p.current[s],e,r),R.current.touched&&j.current[s]&&(Ae(j.current[s],e,r),d())},[s]),prepend:n(e=>{let r=!1;I(),T(De(D.current,g(e)?W(e):[Fe(e,u)])),p.current[s]&&(p.current[s]=De(p.current[s],We(e))),R.current.touched&&j.current[s]&&(j.current[s]=De(j.current[s],We(e)),r=!0),U({shouldRender:r,isPrePend:!0,value:e})},[s]),append:n(e=>{T([...D.current,...g(e)?W(e):[Fe(e,u)]]),U({value:e})},[s]),remove:n(e=>{let r=!1;if(f(e)||z(),I(Le(ye(h.current,s),e)),T(Le(D.current,e)),A(!0),p.current[s]&&(p.current[s]=Le(p.current[s],e),p.current[s].filter(Boolean).length||delete p.current[s]),R.current.touched&&j.current[s]&&(j.current[s]=Le(j.current[s],e),r=!0),R.current.isValid&&!w){let r=-1,t=!1;const n=f(e);for(;r++<C.length;){const c=r===C.length-1,u=(g(e)?e:[e]).indexOf(r)>=0;if((u||n)&&(t=!0),t)for(const e in C[r]){const t=`${s}[${r}].${e}`;if(u||c||n)S.current.delete(t),E.current.delete(t);else{const n=`${s}[${r-1}].${e}`;S.current.has(t)&&S.current.add(n),E.current.has(t)&&E.current.add(n)}}}}U({shouldRender:r,isRemove:!0,index:e})},[C,s]),insert:n((e,r)=>{z(),I(Me(ye(h.current,s),e)),T(Me(D.current,e,g(r)?W(r):[Fe(r,u)])),p.current[s]&&(p.current[s]=Me(p.current[s],e,We(r))),R.current.touched&&j.current[s]&&(j.current[s]=Me(j.current[s],e,We(r)),d())},[s]),fields:C}};const Ue=s=>{var{name:u,rules:l,as:d,onBlur:g,onChange:h,onChangeName:v=b.onChange,onBlurName:p=b.onBlur,valueName:O,defaultValue:y,control:j,onFocus:R}=s,x=we(s,["name","rules","as","onBlur","onChange","onChangeName","onBlurName","valueName","defaultValue","control","onFocus"]);const S=Ne(),{defaultValuesRef:E,setValue:V,register:w,unregister:B,errorsRef:N,removeFieldEventListener:C,triggerValidation:k,mode:{isOnSubmit:F,isOnBlur:$,isOnChange:L},reValidateMode:{isReValidateOnBlur:A,isReValidateOnSubmit:D},formState:{isSubmitted:M},fieldsRef:W,fieldArrayNamesRef:T}=j||S.control,[U,I]=t(f(y)?P(E.current,u):y),z=r(U),H=ae(U),G=$||A,_=r(l),q=a(()=>!xe(T.current,u),[T,u]);_.current=l;const J=()=>!pe({hasError:!!P(N.current,u),isOnBlur:$,isOnSubmit:F,isOnChange:L,isReValidateOnBlur:A,isReValidateOnSubmit:D,isSubmitted:M}),K=e=>{const r=((e,r)=>me(e)||!m(e.target)||m(e.target)&&!e.type?e:r||f(e.target.value)?e.target.checked:e.target.value)(e,H);return I(r),z.current=r,r},Q=n(()=>{xe(T.current,u)&&W.current[u]&&C(W.current[u],!0),w(Object.defineProperty({name:u,focus:R},"value",{set(e){I(e),z.current=e},get:()=>z.current}),_.current)},[T,W,_,u,R,w,C]);c(()=>(Q(),()=>{q&&B(u)}),[u,B,T,Q,q]),c(()=>{Q()},[Q]),c(()=>{W.current[u]||(Q(),q&&I(f(y)?P(E.current,u):y))});const X=Object.assign(Object.assign(Object.assign(Object.assign({name:u},x),h?{[v]:(e=>(...r)=>V(u,K(e(r)),J()))(h)}:{[v]:e=>{const r=K(e);V(u,r,J())}}),g||G?{[p]:(...e)=>{g&&g(e),G&&k(u)}}:{}),{[O||(H?"checked":"value")]:U});return e(d)?o(d,X):i(d,X)},Ie=r=>{var{as:t,errors:n,name:c,message:s,children:u}=r,a=we(r,["as","errors","name","message","children"]);const f=Ne(),d=P(n||f.errors,c);if(!d)return null;const{message:g,types:h}=d,m=Object.assign(Object.assign({},t?a:{}),{children:u?u({message:g||s,messages:h}):g||s});return t?e(t)?o(t,m):i(t,m):i(l,Object.assign({},m))};export{Ue as Controller,Ie as ErrorMessage,Ce as FormContext,Te as useFieldArray,Ve as useForm,Ne as useFormContext};
